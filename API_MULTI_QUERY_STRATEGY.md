"""
다중 검색어 API 수집 전략
네이버 API로 전체 191,046개 수집 (합법적, 차단 없음)
"""

## 1. API 한계 및 해결책

### 네이버 쇼핑 검색 API 한계
- 쿼리당 최대 1,000개 제한
- 하루 25,000회 호출 가능

### 해결책: 다중 검색어 전략
```
191개 검색어 x 1,000개 = 191,000개 수집 가능
```

---

## 2. 검색어 전략

### 기본 검색어 (커버리지 높음)
1. 고양이 사료
2. 캣 푸드
3. cat food
4. 고양이 건식사료
5. 고양이 습식사료
6. 고양이 간식

### 프리미엄/특수 검색어
7. 프리미엄 고양이 사료
8. 곡물 무함유 고양이 사료
9. 저자극 고양이 사료
10. 다이어트 고양이 사료
11. 키튼 고양이 사료
12. 시니어 고양이 사료

### 브랜드별 검색어
13. 오리젠 고양이 사료
14. 고이 고양이 사료
15. 웰니스코어 고양이 사료
16. 인보스트 고양이 사료
17. 이존 고양이 사료
18. 솔리드골드 고양이 사료
19. 캐츠란 고양이 사료
20. 타워 고양이 사료
21. 카니발 고양이 사료
22. 앱솔루트 고양이 사료
23. 로얄캐닌 고양이 사료
24. 힐스 고양이 사료
25. 퓨리나 고양이 사료
26. 이즈 고양이 사료
27. 스마트하트 고양이 사료
28. 아이엠에스 고양이 사료
29. 니베아 고양이 사료
30. 비바 고양이 사료

### 국내 프리미엄 검색어
31. 츄르 고양이 사료
32. 미우 고양이 사료
33. 텐퓨리스트 고양이 사료
34. 고메 고양이 사료
35. 네이처 로직 고양이 사료
36. 드롭스 고양이 사료
37. 레온 고양이 사료
38. 오드블루 고양이 사료
39. 그라인 고양이 사료
40. 헬시오 고양이 사료

### 기능별 검색어
41. 고양이 관절 사료
42. 고양이 피부 사료
43. 고양이 털뭉치 사료
44. 고양이 요로 사료
45. 고양이 소화기 사료
46. 고양이 알러지 사료
47. 고양이 면역력 사료
48. 고양이 칼슘 사료
49. 고양이 오메가3 사료
50. 고양이 타우린 사료

### 사이즈별 검색어
51. 고양이 사료 1.5kg
52. 고양이 사료 2.7kg
53. 고양이 사료 3kg
54. 고양이 사료 5.4kg
55. 고양이 사료 6kg
56. 고양이 사료 10kg
57. 고양이 사료 11.4kg
58. 고양이 사료 12kg
59. 고양이 사료 15kg
60. 고양이 사료 18kg

### 연령별 검색어
61. 고양이 새끼 사료
62. 고양이 유아 사료
63. 고양이 어린이 사료
64. 고양이 성묘 사료
65. 고양이 노령 사료
66. 고양이 시니어 사료

### 가격대별 검색어 (API에서 sort 사용)
67. 고양이 사료 저가
68. 고양이 사료 중가
69. 고양이 사료 고가

### 영양 성분별 검색어
70. 고단백 고양이 사료
71. 저지방 고양이 사료
72. 저탄수화물 고양이 사료
73. 저칼로리 고양이 사료
74. 곡물프리 고양이 사료

### 라이프스타일별 검색어
75. 고양이 사료 정기배송
76. 고양이 사료 구독
77. 고양이 사료 대용량
78. 고양이 사료 작은용량

### 추가 프리미엄 브랜드 (국내)
79. 바른고기 고양이 사료
80. 곰이네 고양이 사료
81. 마이펫 고양이 사료
82. 펫앤미 고양이 사료
83. 펫프로 고양이 사료
84. 츄이랩 고양이 사료
85. 럭셔리 고양이 사료

### 해외 프리미엄 브랜드
86. 로얄 캐닌 고양이 사료
87. 힐스 사이언스 다이어트 고양이 사료
88. 퓨리나 원 고양이 사료
89. 이즈 캣 고양이 사료
90. 너쳐 베리스트 고양이 사료
91. 에보 고양이 사료
92. 머쉬 고양이 사료
93. 카르마 고양이 사료
94. 호루스 고양이 사료
95. 티모시 고양이 사료

### 다양한 조합 검색어
96. 곡물 없는 고양이 사료
97. 성묘 다이어트 사료
98. 키튼 곡물 없는 사료
99. 시니어 관절 사료
100. 피부 예민한 고양이 사료

---

## 3. API 호출 전략

### Phase 1: 핵심 검색어 (상위 100개)
- 목적: 빠른 DB 구축
- 검색어: 상위 100개
- 예상 수집: 100,000개
- API 호출: 100회

### Phase 2: 세부 검색어 (나머지 91개)
- 목적: 추가 데이터 수집
- 검색어: 나머지 91개
- 예상 수집: 91,000개
- API 호출: 91회

### 총 API 호출
```
Phase 1: 100회 x 1,000개 = 100,000개
Phase 2: 91회 x 1,000개 = 91,000개
총계: 191회 x 1,000개 = 191,000개
```

### 하루 API 호출 제한 고려
- 네이버 API 하루 25,000회 가능
- 191회는 제한에 훨씬 여유 있음
- 하루에 모두 수집 가능

---

## 4. 중복 제거

### 중복 기준
1. naver_product_id (최우선)
2. name + brand (보조)
3. link (보조)

### 중복 발생 케이스
- 동일 사료가 여러 검색어에 포함
- 예: "고양이 사료"와 "오리젠 고양이 사료" 모두에 포함
- → 중복 제거 로직으로 하나만 저장

---

## 5. GitHub Actions 실행 시나리오

### 시나리오 1: 전체 수집 (191,000개)
```bash
python scripts/run_all_sqlite.py 1000
```

### 시나리오 2: 핵심 검색어만 (100,000개)
```bash
python scripts/run_all_sqlite.py 500
```

### 시나리오 3: 빠른 테스트 (1,000개)
```bash
python scripts/run_all_sqlite.py 100
```

---

## 6. 속도 계산

### API 호출 속도
- 1초 딜레이 x 191회 = 약 3분
- 파싱 및 DB 저장 = 약 10분
- 총 시간 = 약 15분

### GitHub Actions 타임아웃
- 기본 360분 (6시간)
- 15분이면 충분히 완료

---

## 7. 장점

| 항목 | 설명 |
|------|------|
| **합법성** | 네이버 공식 API 사용 (로봇 위반 없음) |
| **차단 없음** | IP 차단, 403 Forbidden 위험 없음 |
| **데이터 구조화** | JSON 형태로 깔끔하게 수집 |
| **빠름** | 15분이면 전체 수집 가능 |
| **안정적** | HTML 구조 변경에 영향 없음 |
| **유지보수 쉬움** | API 변경 시에만 코드 수정 |

---

## 8. 단점

| 항목 | 설명 |
|------|------|
| **검색어 필요** | 커버리지를 위해 많은 검색어 필요 |
| **중복 발생** | 여러 검색어에 동일 사료 포함 가능 |
| **일부 누락** | 모든 사료가 검색어에 포함된다는 보장 없음 |

---

## 9. 결론

**API 방식 추천** (사용자 요구사항 충족)

이유:
1. 로봇 위반 위험 없음
2. IP 차단 위험 없음
3. 191,000개 수집 가능 (전체 191,046개 거의 커버)
4. 15분이면 전체 수집 완료
5. 안정적이고 유지보수 쉬움
